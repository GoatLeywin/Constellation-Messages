function doPost(e) {
  try {
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Star Stream");
    var data = JSON.parse(e.postData.contents);

    sheet.appendRow([
      data.to || "",
      data.type || "",
      data.scenarioNumber || "",
      data.scenarioName || "",
      data.category || "",
      data.difficulty || "",
      data.clearCondition || "",
      data.timeLimit || "",
      data.rewards || "",
      data.penalty || "",
      data.text || "",
      data.order || ""
    ]);

    var output = ContentService.createTextOutput(
      JSON.stringify({ status: "ok" })
    );
    output.setMimeType(ContentService.MimeType.JSON);
    return output;

  } catch (err) {
    return ContentService.createTextOutput(
      JSON.stringify({ status: "error", message: err.toString() })
    ).setMimeType(ContentService.MimeType.JSON);
  }
}
